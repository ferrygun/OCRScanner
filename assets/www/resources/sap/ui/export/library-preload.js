/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2017 SAP SE. All rights reserved
	
 */
sap.ui.predefine('sap/ui/export/library',['jquery.sap.global','sap/ui/core/library'],function(q,l){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.export",dependencies:["sap.ui.core"],types:["sap.ui.export.EdmType"],interfaces:[],controls:[],elements:[],noLibraryCSS:true,version:"1.52.4"});sap.ui.export.EdmType={Boolean:"Boolean",String:"String",Number:"Number",Date:"Date",Time:"Time",DateTime:"DateTime",Currency:"Currency"};q.sap.registerModuleShims({'sap/ui/export/js/XLSXBuilder':{amd:true,exports:'XLSXBuilder'},'sap/ui/export/js/XLSXExportUtils':{amd:true,exports:'XLSXExportUtils'}});return sap.ui.export;});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2017 SAP SE. All rights reserved
	
 */
sap.ui.predefine('sap/ui/export/ExportDialog',['sap/m/Dialog','sap/m/DialogType','sap/m/Button','sap/m/ProgressIndicator','sap/m/Text','sap/m/MessageBox'],function(D,a,B,P,T,M){'use strict';var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.export");var p;
function c(){var d;var e=new B({text:r.getText("CANCEL_BUTTON"),press:function(){if(d&&d.oncancel){d.oncancel();d.finish();}}});var f=new sap.m.ProgressIndicator({showValue:false,height:"0.75rem"});f.addStyleClass("sapUiMediumMarginTop");d=new D({title:r.getText("PROGRESS_TITLE"),type:a.Message,contentWidth:"500px",content:[new T({text:r.getText("PROGRESS_FETCHING_MSG")}),f],endButton:e});d.updateStatus=function(n){f.setPercentValue(n);};d.finish=function(){p.close();f.setPercentValue(0);};return d;}
function g(){p=p||c();return p;}
function s(m){return new Promise(function(R,f){var w=r.getText("SIZE_WARNING_MSG",[m.rows,m.columns]);var C=false;var d=new D({title:r.getText('PROGRESS_TITLE'),type:a.Message,state:sap.ui.core.ValueState.Warning,content:new T({text:w}),beginButton:new B({text:r.getText("CANCEL_BUTTON"),press:function(){d.close();}}),endButton:new B({text:r.getText("EXPORT_BUTTON"),press:function(){C=true;d.close();}}),afterClose:function(){d.destroy();C?R():f();}});d.open();});}
function b(m){M.error(r.getText("PROGRESS_ERROR_MSG")+"\n"+m,{title:r.getText("PROGRESS_ERROR_TITLE")});}
return{getProgressDialog:g,showErrorMessage:b,showWarningDialog:s};},true);
sap.ui.predefine('sap/ui/export/Spreadsheet',['jquery.sap.global','./library','./ExportDialog','sap/ui/Device'],function(q,l,E,D){'use strict';var S=function(s){this.mSettings=q.extend(true,{},s);};
S.prototype.cancel=function(){if(this.process){this.process.cancel();this.process=null;}};
S.prototype.onprogress=function(P){q.sap.log.debug("Spreadsheet export: "+P+"% loaded.");};
var p=(function(){var r={};for(var k in l.EdmType){r[k.toLowerCase()]=k;}return r;})();var a="Spreadsheet export: ";
function v(P){var b=a;var o="odata";var e=".xlsx";var c=P.count||1;var s;P.fileName=P.fileName||'export';if(!q.sap.endsWith(P.fileName,e)){P.fileName+=e;}var d=P.dataSource;if(typeof d==="string"){P.dataSource={dataUrl:d,type:o,count:c};P.count=c;}else if(Array.isArray(d)){var f=d.map(function(r){return q.extend(true,{},r);});P.dataSource={data:f,type:"array"};}else if(d&&d.dataUrl){s=(d.type||o).toLowerCase();P.dataSource.type=s;if(d.useBatch){}}var g=P.dataSource.sizeLimit;if(s===o&&(!g||isNaN(g))){g=Math.round(c/1000)*200;g=Math.min(10000,Math.max(g,200));q.sap.log.error(b+"dataSource.sizeLimit is not provided. sizeLimit is set to "+g);P.dataSource.sizeLimit=g;}var h=P&&P.workbook;h.columns.forEach(function(i){i.label=i.label||(i.property instanceof Array?i.property[0]:i.property)||"";var w=i.width;if(typeof w==="string"){var W=w.toLowerCase();w=parseFloat(W);if(W.indexOf("em")>0){w=w*2;}else if(W.indexOf("px")>0){w=w/8;}}if(isNaN(w)||w<1){w=10;}if(i.label.length<30){w=Math.max(i.label.length,w);}i.width=Math.round(w);if(i.type){i.type=i.type.toLowerCase();if(!p[i.type]){q.sap.log.error(b+"insupported column property type "+i.type+". Type is reverted to 'string'.");i.type="";}if(i.type==="currency"&&!i.unitProperty){q.sap.log.error(b+"missing unit property for currency column. Type is reverted to 'string'.");i.type="";}}var j=i.scale;if(i.type==="number"&&isNaN(j)&&j!=="variable"){q.sap.log.warning(b+"scale parameter for numerical column configuration is missing.");}if(typeof j==="string"){j=parseInt(j,10);}if(isNaN(j)){j=null;}i.scale=j;var t=(i.textAlign+"").toLowerCase();if(t!==""&&["left","right","center","begin","end"].indexOf(t)==-1){q.sap.log.warning(b+"incorrect column alignment property: "+t+". Default alignment is used.");t="";}i.textAlign=t;});}
S.prototype.build=function(){var s=this;var P=q.extend(true,{},this.mSettings);v(P);return new Promise(function(r,R){var b;var c=D.system.desktop?2000000:100000;var n=P.dataSource.count;var d=P.workbook.columns.length;function o(m){if(!isNaN(m.progress)){if(b){b.updateStatus(m.progress);}s.onprogress(m.progress);}if(m.error||m.finish){s.process=null;if(b){b.finish();}if(m.error){R(m.error);E.showErrorMessage(m.error);}else if(m.finish){r();}}}if(s.process){R("Cannot start export: the process is already running");return;}function e(){if(P.showProgress!==false){b=E.getProgressDialog();b.oncancel=function(){return s.process&&s.process.cancel();};b.open();}s.process=sap.ui.requireSync("sap/ui/export/SpreadsheetExport").execute(P,o);}if(n*d>c){E.showWarningDialog({rows:n,columns:d}).then(e).catch(function(){R('Export cancelled by the user.');});}else{e();}});};
return S;},true);
sap.ui.predefine('sap/ui/export/SpreadsheetExport',['jquery.sap.global'],function(q){'use strict';var L="sap/ui/thirdparty/jszip",a="sap/ui/export/js/XLSXExportUtils",b="sap/ui/export/js/XLSXBuilder";
function d(p,c){function f(m){return c&&c(m);}function o(v){f({progress:v});}function g(e){f({error:e.message||e});}function h(){f({finish:true});}function i(){var s;var S;var C;var t;function e(X,v){S=X.saveFile;C=X.oData.getConverter(p);s=new v(p.workbook.columns);o(0);t=window.setTimeout(l,0);}function l(){if(s){var D=p.dataSource.data||[];var R=C(D.slice());s.append(R);o(50);t=window.setTimeout(m,0);}}function m(){if(s){s.build().then(r);}}function r(v){if(v){S(new Blob([v]),p.fileName);}h();s=null;}function u(){window.clearTimeout(t);r();}sap.ui.require([a,b,L],e);return{cancel:u};}function n(u){return u?window.URI(u).absoluteTo(window.location.href).toString():u;}function j(){var s,r,S;function e(X,u){S=X.saveFile;s=new u(p.workbook.columns);r=X.oData.fetch(p,l);o(0);}function l(M){if(M.rows){s.append(M.rows);}if(M.progress){o(M.progress);}if(M.error){s=null;return g(M.error);}return M.finished&&s.build().then(m);}function m(u){S(new Blob([u]),p.fileName);h();s=null;}function t(){r.cancel();h();s=null;}sap.ui.require([a,b,L],e);return{cancel:t};}function k(){var l;var s;var m=q.extend(true,{},p);var w=typeof m.worker==="object"?m.worker:{};var C=function(){s.postMessage({cancel:true});h();};function r(x){var y=new Worker(x);y.onmessage=function(e){if(e.data.status){o(e.data.status);}else if(e.data.error){g(e.data.error);}else{l.saveFile(new Blob([e.data]),m.fileName);h();}};y.postMessage(m);return y;}function t(){q.sap.log.warning("Direct worker is not allowed. Load the worker via blob.");var e=window.URI(w.base).absoluteTo().search("").hash("").toString();w.src=e+w.ref;var x='self.origin = "'+e+'"; '+'importScripts("'+w.src+'")';var y=new Blob([x]);var z=window.URL.createObjectURL(y);return r(z);}function u(){q.sap.log.warning("Blob worker is not allowed. Use in-process export.");C=j(m).cancel;}function v(X){l=X;try{s=r(w.src);s.addEventListener("error",function(e){s=t();s.addEventListener("error",function(e){u();e.preventDefault();});e.preventDefault();});}catch(x){try{s=t();}catch(y){u();}}}m.dataSource.dataUrl=n(m.dataSource.dataUrl);m.dataSource.serviceUrl=n(m.dataSource.serviceUrl);w.base=w.base||sap.ui.resource("sap.ui.export.js","");w.ref=w.ref||"SpreadsheetWorker.js";w.src=w.base+w.ref;sap.ui.require([a],v);return{cancel:function(){C();}};}if(p.dataSource.type==="array"){return i();}else if(p.worker===false||sap.ui.disableExportWorkers===true){return j();}else{return k();}}
return{execute:d};},true);
jQuery.sap.registerPreloadedModules({
"name":"sap/ui/export/library-preload",
"version":"2.0",
"modules":{
	"sap/ui/export/manifest.json":'{\n  "_version": "1.9.0",\n  "sap.app": {\n    "id": "sap.ui.export",\n    "type": "library",\n    "embeds": [],\n    "applicationVersion": {\n      "version": "1.52.4"\n    },\n    "title": "UI5 library: sap.ui.export",\n    "description": "UI5 library: sap.ui.export",\n    "resources": "resources.json",\n    "offline": true\n  },\n  "sap.ui": {\n    "technology": "UI5",\n    "supportedThemes": [\n      "base",\n      "sap_belize",\n      "sap_belize_plus",\n      "sap_hcb"\n    ]\n  },\n  "sap.ui5": {\n    "dependencies": {\n      "minUI5Version": "1.52",\n      "libs": {\n        "sap.ui.core": {\n          "minVersion": "1.52.4"\n        }\n      }\n    },\n    "library": {\n      "i18n": "messagebundle.properties",\n      "css": false,\n      "content": {\n        "controls": [],\n        "elements": [],\n        "types": [\n          "sap.ui.export.EdmType"\n        ],\n        "interfaces": []\n      }\n    }\n  }\n}'
}});
//# sourceMappingURL=library-preload.js.map